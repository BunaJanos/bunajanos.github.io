<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <title>Smartphone Market Analytics - CSV Edition</title>
    <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #0f172a; color: #fff; padding: 20px; }
        .container { max-width: 1200px; margin: 0 auto; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(450px, 1fr)); gap: 20px; }
        .card { background: rgba(255,255,255,0.05); border-radius: 15px; padding: 20px; border: 1px solid #334155; }
        h1 { text-align: center; color: #38bdf8; margin-bottom: 30px; }
        .full-width { grid-column: 1 / -1; }
        .chart { width: 100%; height: 350px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üì± Smartphone Market Analytics</h1>
        <div class="grid">
            <div class="card">
                <h3>üåê √âl≈ë USD/HUF √Årfolyam (API)</h3>
                <div id="chart-api" class="chart"></div>
            </div>

            <div class="card">
                <h3>ü•ß Piaci r√©szesed√©s (M√°rk√°k)</h3>
                <div id="chart-pie" class="chart"></div>
            </div>

            <div class="card full-width">
                <h3>üîç Interakt√≠v: √År vs. RAM (Kereshet≈ë)</h3>
                <div id="chart-scatter" class="chart"></div>
            </div>

            <div class="card">
                <h3>üí∞ √Åtlag√°r gy√°rt√≥nk√©nt (USD)</h3>
                <div id="chart-bar" class="chart"></div>
            </div>

            <div class="card">
                <h3>üîã Akkumul√°tor kapacit√°s trend</h3>
                <div id="chart-hist" class="chart"></div>
            </div>

            <div class="card full-width">
                <h3>üìà Megjelen√©sek sz√°ma az √©vek sor√°n</h3>
                <div id="chart-line" class="chart"></div>
            </div>
        </div>
    </div>

    <script>
        // A te CSV f√°jlod neve a GitHub-on
        const csvFile = "Mobiles Dataset (2025).csv";
        
        // CSV be√°ll√≠t√°sok (Mivel pontosvessz≈ës a f√°jlod!)
        const csvData = {
            "url": csvFile,
            "format": {"type": "csv", "delimiter": ";"}
        };

        // 1. API h√≠v√°s (Currency)
        async function fetchCurrency() {
            const res = await fetch('https://open.er-api.com/v6/latest/USD');
            const data = await res.json();
            const rate = data.rates.HUF;
            const apiSpec = {
                "data": {"values": [{"c": "USD", "v": 1}, {"c": "HUF", "v": rate}]},
                "mark": "bar",
                "encoding": {
                    "x": {"field": "c", "type": "nominal", "title": "P√©nznem"},
                    "y": {"field": "v", "type": "quantitative", "title": "√ârt√©k"}
                }
            };
            vegaEmbed('#chart-api', apiSpec);
        }

        // 2. Pie Chart
        const pieSpec = {
            "data": csvData,
            "mark": {"type": "arc", "innerRadius": 50},
            "encoding": {
                "theta": {"aggregate": "count", "type": "quantitative"},
                "color": {"field": "Company Name", "type": "nominal"}
            }
        };

        // 3. Interakt√≠v Scatter Plot
        const scatterSpec = {
            "data": csvData,
            "selection": { "pts": {"type": "multi", "on": "mouseover", "toggle": "true"} },
            "mark": "point",
            "encoding": {
                "x": {"field": "Launched Price (USA)", "type": "quantitative", "title": "√År (USD)"},
                "y": {"field": "RAM", "type": "quantitative", "title": "RAM"},
                "color": {"condition": {"selection": "pts", "field": "Company Name", "type": "nominal"}, "value": "grey"},
                "tooltip": [{"field": "Model "}, {"field": "Launched Price (USA)"}]
            }
        };

        // 4. Bar Chart
        const barSpec = {
            "data": csvData,
            "mark": "bar",
            "encoding": {
                "x": {"aggregate": "mean", "field": "Launched Price (USA)", "type": "quantitative"},
                "y": {"field": "Company Name", "type": "nominal", "sort": "-x"}
            }
        };

        // 5. Histrogram (Akkumul√°tor)
        const histSpec = {
            "data": csvData,
            "mark": "bar",
            "encoding": {
                "x": {"field": "Battery Capacity", "type": "nominal", "title": "Kapacit√°s"},
                "y": {"aggregate": "count", "type": "quantitative"}
            }
        };

        // 6. Line Chart (√âvek)
        const lineSpec = {
            "data": csvData,
            "mark": "line",
            "encoding": {
                "x": {"field": "Launched Year", "type": "ordinal"},
                "y": {"aggregate": "count", "type": "quantitative"}
            }
        };

        fetchCurrency();
        vegaEmbed('#chart-pie', pieSpec);
        vegaEmbed('#chart-scatter', scatterSpec);
        vegaEmbed('#chart-bar', barSpec);
        vegaEmbed('#chart-hist', histSpec);
        vegaEmbed('#chart-line', lineSpec);
    </script>
</body>
</html>
